<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SquidpyR">
<title>Reproducing figures from squidpy manuscript • SquidpyR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproducing figures from squidpy manuscript">
<meta property="og:description" content="SquidpyR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SquidpyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.99.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A_squidpySetup.html">Setting up computer for squidpy</a>
    <a class="dropdown-item" href="../articles/B_reproduceSquidpyData.html">Reproducing data in squidpy package</a>
    <a class="dropdown-item" href="../articles/C_reproduceSquidpyFigures.html">Reproducing figures from squidpy manuscript</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Kayla-Morrell/SquidpyR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Reproducing figures from squidpy manuscript</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Kayla-Morrell/SquidpyR/blob/HEAD/vignettes/C_reproduceSquidpyFigures.Rmd" class="external-link"><code>vignettes/C_reproduceSquidpyFigures.Rmd</code></a></small>
      <div class="d-none name"><code>C_reproduceSquidpyFigures.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will demonsrate to the user how to reproduce some
figures from the Squidpy <a href="https://www.nature.com/articles/s41592-021-01358-2#Sec24" class="external-link">manuscript</a>.
The authors of squpidpy documented their work via a <a href="https://github.com/theislab/squidpy_reproducibility/blob/master/notebooks/graph_figures/seqfish.ipynb" class="external-link">Jupyter
notebook</a> that we then translated into R code. The steps below use
the R package reticulate to translate python code into R code that then
create figures from the manuscript. Reticulate makes it very easy to use
python code within R with very few changes. We will do a couple
comparisons between python code and the reticulate R code to demonstrate
where changes may have to be made.</p>
</div>
<div class="section level2">
<h2 id="set-up">Set up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h2>
<div class="section level3">
<h3 id="import-python-packages">Import python packages<a class="anchor" aria-label="anchor" href="#import-python-packages"></a>
</h3>
<p>Reticulate has a very convenient function for importing the python
libraries needed to perform certain tasks. It is important to note that
the environment where squidpy was installed should be active in order
for this code to work.</p>
<p>For examples, I named my conda environment squidpy so I’ll run
<code>conda activate squidpy</code> before running the follow code in
R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"scanpy"</span><span class="op">)</span></span>
<span><span class="va">sq</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"squidpy"</span><span class="op">)</span></span>
<span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"matplotlib.pyplot"</span><span class="op">)</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"seaborn"</span><span class="op">)</span></span>
<span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"pandas"</span><span class="op">)</span></span>
<span><span class="va">np</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"numpy"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="tabset tabset-pills" id="settings">Settings<a class="anchor" aria-label="anchor" href="#settings"></a>
</h3>
<p>There are some setting that are set in the Jupyter notebook that can
be done here as well. When converting python code to R code any
<code>.</code> will become a <code>$</code>. The first code chunk is a
python code chunk and then the following code chunk would be the
corresponding R code. Some settings did not translate so I will comment
them out in the python code.</p>
<div class="section level4">
<h4 id="python-code">Python code<a class="anchor" aria-label="anchor" href="#python-code"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sc.logging.print_header()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scanpy==1.9.3 anndata==0.9.1 umap==0.5.3 numpy==1.22.4 scipy==1.9.1 pandas==2.0.0 scikit-learn==1.2.2 statsmodels==0.13.5 python-igraph==0.10.4 pynndescent==0.5.9</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sc.set_figure_params(facecolor<span class="op">=</span><span class="st">"white"</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>sc.settings.verbosity <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#sc.settings.dpi = 300</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#sq.__version__</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>sc.settings.figdir <span class="op">=</span> <span class="st">"./figures"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="r-code">R code<a class="anchor" aria-label="anchor" href="#r-code"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc</span><span class="op">$</span><span class="va">logging</span><span class="op">$</span><span class="fu">print_header</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sc</span><span class="op">$</span><span class="fu">set_figure_params</span><span class="op">(</span>facecolor<span class="op">=</span><span class="st">"white"</span>, figsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sc</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">verbosity</span> <span class="op">=</span> <span class="st">'hint'</span></span>
<span><span class="va">sc</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">figdir</span> <span class="op">=</span> <span class="st">"./figures"</span></span>
<span></span>
<span><span class="va">PATH_FIGURES</span> <span class="op">=</span> <span class="st">"./figures"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="obtain-data">Obtain data<a class="anchor" aria-label="anchor" href="#obtain-data"></a>
</h3>
<p>The data used is provided as part of the squpidpy package. We load it
into R with the following code, note that is is an anndata object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adata</span> <span class="op">&lt;-</span> <span class="va">sq</span><span class="op">$</span><span class="va">datasets</span><span class="op">$</span><span class="fu">seqfish</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">adata</span> <span class="co"># 19416 obs x 351 vars</span></span>
<span><span class="co">#&gt; AnnData object with n_obs × n_vars = 19416 × 351</span></span>
<span><span class="co">#&gt;     obs: 'Area', 'celltype_mapped_refined'</span></span>
<span><span class="co">#&gt;     uns: 'celltype_mapped_refined_colors'</span></span>
<span><span class="co">#&gt;     obsm: 'X_umap', 'spatial'</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h2>
<p>For the rest of this vignette we will be following the Jupyter
notebook and translating the python code to R. Each plot is created and
saved in the figures directory for future use.</p>
<div class="section level3">
<h3 id="figure-1">Figure 1<a class="anchor" aria-label="anchor" href="#figure-1"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc</span><span class="op">$</span><span class="va">pl</span><span class="op">$</span><span class="fu">spatial</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>,</span>
<span>    save <span class="op">=</span> <span class="st">"_seqfish.png"</span>,</span>
<span>    spot_size <span class="op">=</span> <span class="fl">0.03</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/show_seqfish.png" alt=""><p class="caption">Figure 1</p>
</div>
</div>
<div class="section level3">
<h3 id="figure-2">Figure 2<a class="anchor" aria-label="anchor" href="#figure-2"></a>
</h3>
<p>For this figure we will show the python code and the corresponding R
code to demonstrate where there may be some differences.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sq.gr.spatial_neighbors(adata, delaunay<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating graph using `generic` coordinates and `None` transform and `1` libraries.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding `adata.obsp['spatial_connectivities']`</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        `adata.obsp['spatial_distances']`</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        `adata.uns['spatial_neighbors']`</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Finish (0:00:02)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sq.gr.nhood_enrichment(adata, cluster_key<span class="op">=</span><span class="st">"celltype_mapped_refined"</span>, n_perms<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Calculating neighborhood enrichment using `1` core(s)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="op">%|</span>          <span class="op">|</span> <span class="dv">0</span><span class="op">/</span><span class="dv">1000</span> [<span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span>?, ?<span class="op">/</span>s]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span><span class="op">%|</span><span class="dv">4</span>         <span class="op">|</span> <span class="dv">41</span><span class="op">/</span><span class="dv">1000</span> [<span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span>, <span class="fl">401.37</span><span class="op">/</span>s]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">10</span><span class="op">%|</span><span class="co">#         | 104/1000 [00:00&lt;00:01, 531.78/s]</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">17</span><span class="op">%|</span><span class="co">#7        | 173/1000 [00:00&lt;00:01, 601.03/s]</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">24</span><span class="op">%|</span><span class="co">##3       | 239/1000 [00:00&lt;00:01, 623.33/s]</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">30</span><span class="op">%|</span><span class="co">###       | 304/1000 [00:00&lt;00:01, 632.80/s]</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">39</span><span class="op">%|</span><span class="co">###8      | 387/1000 [00:00&lt;00:00, 697.54/s]</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">46</span><span class="op">%|</span><span class="co">####5     | 457/1000 [00:00&lt;00:00, 689.27/s]</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">53</span><span class="op">%|</span><span class="co">#####2    | 526/1000 [00:00&lt;00:00, 657.12/s]</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">59</span><span class="op">%|</span><span class="co">#####9    | 594/1000 [00:00&lt;00:00, 662.79/s]</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">66</span><span class="op">%|</span><span class="co">######6   | 661/1000 [00:01&lt;00:00, 656.82/s]</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">73</span><span class="op">%|</span><span class="co">#######2  | 727/1000 [00:01&lt;00:00, 656.64/s]</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">79</span><span class="op">%|</span><span class="co">#######9  | 793/1000 [00:01&lt;00:00, 656.43/s]</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">86</span><span class="op">%|</span><span class="co">########6 | 865/1000 [00:01&lt;00:00, 674.37/s]</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">93</span><span class="op">%|</span><span class="co">#########3| 933/1000 [00:01&lt;00:00, 672.70/s]</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="op">%|</span><span class="co">##########| 1000/1000 [00:01&lt;00:00, 657.47/s]</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding `adata.uns['celltype_mapped_refined_nhood_enrichment']`</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Finish (0:00:01)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array(adata.uns[<span class="st">"celltype_mapped_refined_nhood_enrichment"</span>][<span class="st">"zscore"</span>])</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>sq.pl.nhood_enrichment(</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    adata,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    cluster_key<span class="op">=</span><span class="st">"celltype_mapped_refined"</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"coolwarm"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">"ward"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"nhod_seqfish.png"</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    cbar_kwargs<span class="op">=</span>{<span class="st">"label"</span>: <span class="st">"Z-score"</span>},</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    vmin<span class="op">=-</span><span class="dv">50</span>,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    vmax<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sq</span><span class="op">$</span><span class="va">gr</span><span class="op">$</span><span class="fu">spatial_neighbors</span><span class="op">(</span><span class="va">adata</span>, delaunay <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># added to adata.obsp, adata.uns</span></span>
<span><span class="va">sq</span><span class="op">$</span><span class="va">gr</span><span class="op">$</span><span class="fu">nhood_enrichment</span><span class="op">(</span><span class="va">adata</span>, cluster_key <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>, n_perms <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># added to adata.uns</span></span>
<span></span>
<span><span class="va">arr</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="va">adata</span><span class="op">$</span><span class="va">uns</span><span class="op">[</span><span class="st">"celltype_mapped_refined_nhood_enrichment"</span><span class="op">]</span><span class="op">[</span><span class="st">"zscore"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sq</span><span class="op">$</span><span class="va">pl</span><span class="op">$</span><span class="fu">nhood_enrichment</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    cluster_key <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>,</span>
<span>    cmap <span class="op">=</span> <span class="st">"coolwarm"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">""</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"ward"</span>,</span>
<span>    dpi <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    figsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    save <span class="op">=</span> <span class="st">"nhood_seqfish.png"</span>,</span>
<span>    cbar_kwargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Z-score"</span><span class="op">)</span>,</span>
<span>    vmin <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>,</span>
<span>    vmax <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/nhood_seqfish.png" alt=""><p class="caption">Figure 2</p>
</div>
</div>
<div class="section level3">
<h3 id="figure-3">Figure 3<a class="anchor" aria-label="anchor" href="#figure-3"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sq</span><span class="op">$</span><span class="va">pl</span><span class="op">$</span><span class="fu">nhood_enrichment</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    cluster_key <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>,</span>
<span>    cmap <span class="op">=</span> <span class="st">"inferno"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">""</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"ward"</span>,</span>
<span>    dpi <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    figsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    save <span class="op">=</span> <span class="st">"nhod_seqfish.png"</span>,</span>
<span>    cbar_kwargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Z-score"</span><span class="op">)</span>,</span>
<span>    vmin <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>,</span>
<span>    vmax <span class="op">=</span> <span class="fl">150</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/nhod_seqfish.png" alt=""><p class="caption">Figure 3</p>
</div>
</div>
<div class="section level3">
<h3 id="figure-4">Figure 4<a class="anchor" aria-label="anchor" href="#figure-4"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ax</span> <span class="op">&lt;-</span> <span class="va">plt</span><span class="op">$</span><span class="fu">subplots</span><span class="op">(</span></span>
<span>    figsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sc</span><span class="op">$</span><span class="va">pl</span><span class="op">$</span><span class="fu">spatial</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>,</span>
<span>    groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Endothelium"</span>,</span>
<span>        <span class="st">"Haematoendothelial progenitors"</span>,</span>
<span>        <span class="st">"Allantois"</span>,</span>
<span>        <span class="st">"Lateral plate mesoderm"</span>,</span>
<span>        <span class="st">"Intermediate mesoderm"</span>,</span>
<span>        <span class="st">"Presomitic mesoderm"</span>,</span>
<span>        <span class="st">"Dermomyotome"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    save <span class="op">=</span> <span class="st">"_endo_seqfish.png"</span>,</span>
<span>    frameon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="co">#    ax = ax,</span></span>
<span>    show <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    spot_size <span class="op">=</span> <span class="fl">0.03</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; &lt;Axes: title={'center': 'celltype_mapped_refined'}, xlabel='spatial1', ylabel='spatial2'&gt;</span></span></code></pre></div>
<div class="figure">
<img src="figures/show_endo_seqfish.png" alt=""><p class="caption">Figure 4</p>
</div>
</div>
<div class="section level3">
<h3 id="figure-5">Figure 5<a class="anchor" aria-label="anchor" href="#figure-5"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc</span><span class="op">$</span><span class="va">pl</span><span class="op">$</span><span class="fu">spatial</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>,</span>
<span>    groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Allantois"</span>,</span>
<span>        <span class="st">"Lateral plate mesoderm"</span>,</span>
<span>        <span class="st">"Intermediate mesoderm"</span>,</span>
<span>        <span class="st">"Presomitic mesoderm"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    save <span class="op">=</span> <span class="st">"_meso_seqfish.png"</span>,</span>
<span>    spot_size <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span><span class="co">#    ax = ax,</span></span>
<span>    show <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; &lt;Axes: title={'center': 'celltype_mapped_refined'}, xlabel='spatial1', ylabel='spatial2'&gt;</span></span></code></pre></div>
<div class="figure">
<img src="figures/show_meso_seqfish.png" alt=""><p class="caption">Figure 5</p>
</div>
</div>
<div class="section level3">
<h3 id="figure-6">Figure 6<a class="anchor" aria-label="anchor" href="#figure-6"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sq</span><span class="op">$</span><span class="va">gr</span><span class="op">$</span><span class="fu">co_occurrence</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    cluster_key <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span></span>
<span><span class="op">)</span> <span class="co"># added to adata.uns</span></span>
<span></span>
<span></span>
<span><span class="va">sq</span><span class="op">$</span><span class="va">pl</span><span class="op">$</span><span class="fu">co_occurrence</span><span class="op">(</span></span>
<span>    <span class="va">adata</span>,</span>
<span>    cluster_key <span class="op">=</span> <span class="st">"celltype_mapped_refined"</span>,</span>
<span>    clusters <span class="op">=</span> <span class="st">"Lateral plate mesoderm"</span>,</span>
<span>    figsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dpi <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    save <span class="op">=</span> <span class="st">"co_occurrence_seqfish"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/co_occurrence_seqfish.png" alt=""><p class="caption">Figure 6</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kayla Interdonato.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
